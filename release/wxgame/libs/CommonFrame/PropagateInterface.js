tywx.PropagateInterface={_cachedShareConfig:void 0,_rawConfigInfo:void 0,_connectConfigInfo:{},getShareConfigInfoAutoWeight:function(){return this._shuffleByWeights()},_doHttpGetShareConfig:function(){var t={},e=(new Date).getTime();t.act="api.getShareConfig",t.time=e,t.game_mark=tywx.SystemInfo.cloudId+"-"+tywx.SystemInfo.gameId;var n=this.getConfigSignStr(t),i=[];for(var r in t)i.push(r+"="+t[r]);i.push("sign="+n);var o=tywx.SystemInfo.shareManagerUrl+"?"+i.join("&"),a=this;tywx.HttpUtil.httpGet({url:o},function(t){t.retmsg&&(a._rawConfigInfo=t.retmsg,a.processRawShareConfigInfo(),a.connectRawShareConfigInfo())},function(t){tywx.NotificationCenter.trigger(tywx.EventType.GET_SHARE_CONFIG_FAIL,t);setTimeout(function(){a._doHttpGetShareConfig()},1e4)})},_shuffleByWeights:function(){var t={};for(var e in this._cachedShareConfig)if("shareExt"!=e){var n=this._cachedShareConfig[e];if(0==n.length)t[e]={};else if(1==n.length)t[e]=n[0];else for(var i=n.reduce(function(t,e){return t+e.weight},0),r=Math.random()*i,o=0;o<n.length;o++)if((r-=n[o].weight)<=0){t[e]=n[o];break}}return t},getUserFeatureInfo:function(){var t={},e=(new Date).getTime();t.act="api.getUserFeature",t.cloud_id=tywx.SystemInfo.cloudId,t.game_id=tywx.SystemInfo.gameId,t.user_id=tywx.UserInfo.userId,t.time=e;var n=this.getConfigSignStr(t),i=[];for(var r in t)i.push(r+"="+t[r]);i.push("sign="+n);var o=tywx.SystemInfo.shareManagerUrl+"?"+i.join("&");tywx.HttpUtil.httpGet({url:o},function(t){tywx.NotificationCenter.trigger(tywx.EventType.GET_USER_FEATURE_SUCCESS,t)},function(t){tywx.NotificationCenter.trigger(tywx.EventType.GET_USER_FEATURE_FAIL,t)})},processRawShareConfigInfo:function(){var t=this;if(this._cachedShareConfig={},this._rawConfigInfo&&tywx.UserInfo.userId){for(var e=Object.keys(this._rawConfigInfo),n=0,i=e.length;n<i;n++){var r=this._rawConfigInfo[e[n]],o=r.length;this._cachedShareConfig[e[n]]=[],0<o&&r.forEach(function(i){var r=i.filter_user||[],o=r.length;if(0==o)t._cachedShareConfig[e[n]].push(i);else{for(var a=!1,f=0;f<o;f++){var g=tywx.UserInfo.userId.toString();if(g.charAt(g.length-1)==r[f]){a=!0;break}}a||t._cachedShareConfig[e[n]].push(i)}})}tywx.NotificationCenter.trigger(tywx.EventType.GET_SHARE_CONFIG_SUCCESS,this._shuffleByWeights())}},connectRawShareConfigInfo:function(){for(var t in this._rawConfigInfo){var e=this._rawConfigInfo[t];if(0!=e.length){var n=e[0].sharePointId.toString(),i=e[0].template_type;this._connectConfigInfo[n]=i}}},getConfigSignStr:function(t){for(var e=Object.keys(t).sort(),n="",i=0;i<e.length;i++){var r=e[i];"act"!=r&&"sign"!=r&&(n+=r+"="+t[r])}return tywx.hex_md5("market.tuyoo.com-api-"+n+"-market.tuyoo-api")||""}};